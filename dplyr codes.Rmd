---
title: "dplyr sample codes"
author: "Sedi Abbasnasab"
date: "`r Sys.Date()`"
output: html_document
---

```{r}
require(dplyr)
```
#load data
```{r}
demo <- read.csv("demographics.csv")
View(demo)
```
#filtering
#owners with the income greater than 55
```{r}
demo2 <- filter(demo, income>55)
View(demo2)
```
#owners with income equal to 60
```{r}
demo2 <- filter(demo, income==60)
View(demo2)
```
#married owners
```{r}
demo2 <- filter(demo, marital=='Married')
View(demo2)
```
#married owners with the income greater than 55
```{r}
demo2 <- filter(demo, marital=='Married', income>55)
View(demo2)
```
#multiple conditions
```{r}
demo2 <- filter(demo, marital=='Married', income>55, carcat=='Luxury')
View(demo2)
```
#owners with age between 35 and 45
```{r}
demo2 <- filter(demo, age>=35, age<=45)
View(demo2)
```
#owners who are married OR the income greater than 55
```{r}
demo2 <- filter(demo, income>55 | marital=='Married')
View(demo2)
```
#owners aged 42, 45 and 60
```{r}
demo2 <- filter(demo, age %in% c(42, 45, 60))
View(demo2)
```
#owners with the ages different from 42, 45 and 60
```{r}
demo2 <- filter(demo, !age %in% c(42, 45, 60))
View(demo2)
```

#Select
#select the variables age, marital status and gender
```{r}
demo2 <- select(demo, age, marital, gender)
View(demo2)
```
#use colon to select a range of variables
```{r}
demo2 <- select(demo, income:carcat)
View(demo2)
```
#select the third and the fifth variable
```{r}
demo2 <- select(demo, c(3, 5))
View(demo2)
```
#select the variables from the second to the forth
```{r}
demo2 <- select(demo, 2:4)
View(demo2)
```
#remove variables age and income
```{r}
demo2 <- select(demo, -age, -income)
View(demo2)
```
#remove the sixth and the eighth variable
```{r}
demo2 <- select(demo, -6, -8)
View(demo2)
```
#remove the first three variables
```{r}
demo2 <- select(demo, -1:3)
View(demo2)
```
#select the variables that contain a certain string
```{r}
demo2 <- select(demo, contains("ret"))
View(demo2)
```
#select the variables that start with the specified string
```{r}
demo2 <- select(demo, starts_with("in"))
```
#select the variables that end with the specified string
```{r}
demo2 <- select(demo, ends_with("cat"))
View(demo2)
```

#Mutate
#add a new variable containing the difference between income and car price
```{r}
demo2 <- mutate(demo, income2 = income * 10)
View(demo2)
```
#add another variable containing the difference between income and car price
```{r}
demo2 <- mutate(demo, diff = income - carpr)
View(demo2)
```
#Creat a vector and add it to data frame as a variable
#the vector lenght must be equal to the number of rows in the data frame
```{r}
y <- rnorm(510, 0, 1)
demo2 <- mutate(demo2, new_var=y)
View(demo2)
```
#divide variables 1 and 5 to 1000
```{r}
demo2 <- mutate(demo2, across(c(1,5), ~ ./1000, .names = "{col}_2"))
View(demo2)
```
#devide all the numeric variables to 1000
```{r}
demo2 <- mutate(demo, across(where(is.numeric), ~ ./1000, .names = "{col}_2"))
View(demo2)
```
#multiply colums 1 and 5 by 3
```{r}
demo2 <- mutate(demo, across(c(1,5), ~ .*3, .names = "{col}_new"))
View(demo2)
```
#compute the means of the columns 1 and 5
```{r}
demo2 <- mutate(demo, across(c(1,5), .fns = mean, .names = "{col}_mean"))
View(demo2)
```
#compute the means of all numeric variables
```{r}
demo2 <- mutate(demo, across(where(is.numeric), .fns = mean, .names = "{col}_mean"))
View(demo2)
```
#use the filter() function inside the mutate() function
#divide columns 1,3 and 5 by 1000 for the retired owners only
```{r}
demo2 <- mutate(filter(demo, retired =="Yes"), across(c(1,3, 5), ~ ./1000, .names = "{col}_2"))
View(demo2)
```